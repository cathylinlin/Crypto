# RSA
## 基本
最基本的内容。  
RSA密码的全过程。  
### 公钥产生
1. 选取两个大素数 $p$ $q$  
2. 计算模数 $n = pq$
3. 计算 $n$ 的欧拉函数值 $\varphi(n)=(p-1)(q-1)$
4. 选取和 $\varphi$(n) 互素的数 $e$
5. 计算 $e$ 关于 $\varphi(n)$ 的模逆元 $d$ ，即 $ed\equiv 1\pmod{\varphi(n)}$
6. 公钥为 $(n,e)$ ，私钥为 $(n,d)$

### 加密
1. 将要加密的消息编码为数字 $m$
2. 密文 $c\equiv m^e\pmod{\varphi(n)}$

### 解密
1. $m\equiv c^d\pmod{\varphi(n)}$

### 解密的正确性
$c^d\equiv {m}^{ed} \equiv {m}^{k\varphi(n) +1} \equiv m \pmod{n} $   
1. 如果 $gcd(m,n)=1$ 那么最后一个等号显然成立（见欧拉定理）
2. 如果 $gcd(m,n)\neq 1$ ，那么 $m$ 必然是 $p$ 或 $q$ 的倍数，可以设 $m=k_1q$ ，  
   于是 ${m}^{\varphi(p)}\equiv{m}^{p-1}\equiv 1\pmod{p}$  
   ${m}^{k\varphi(n)}\equiv{m}^{k(p-1)(q-1)}\equiv 1\pmod{p}$  
   ${m}^{k\varphi(n)+1}\equiv m(k_2p+1)\equiv m+k_2pm\equiv m+k_1k_2pq\equiv m\pmod{n}$   
因此解密是正确的。
